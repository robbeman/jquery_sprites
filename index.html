<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="author" content="Robbe Clerckx" />
	<title>jQuery spritesheet animation</title>
	
	<style>
	/*simple style reset*/
	*{
		margin:0px;
		padding:0px;
	}
	body{
		color:white;
		background-color:black;
		font-family:Helvetica,Arial,sans-serif;
	}


	.sprite{
		background:url(sparksy.png) top left no-repeat;
		width:128px;
		height:128px;
		position:absolute;

		pointer-events:none;
	}

	</style>
	<link rel="shortcut icon" type="image/png" href="favicon.ico" />

	<script type="text/javascript" src="jquery-1.9.1.min.js"></script>
	<script type="text/javascript">



	(function($){



		$.fn.sprite = function(options,params){

			//for now, only allow one item to be created at once
			var t = $(this).first();

			if(t.length <= 0) return false;

			if (typeof options === 'string'){
				//execute the needed function
				var method = methods[options];
				if(typeof method === 'function'){
					method.apply(t,Array.prototype.slice.call(arguments,1));
				}
			}
			else{
				//initialise the sprite
				var width = t.width(),
					height = t.height(),
					frames = [],
					settings = $.extend({
						frames: 1,
						sheetWidth:width,
						sheetHeight:height
					},options
				);

				if (typeof settings.frames === "number"){
					//calculate the frames by the width and height of the spritesheet
					var cols = settings.sheetWidth/width;
					for(var i=0;i<settings.frames;i++){
						frames.push([
							(i%cols)*width,
							Math.round(i/cols)*height
						]);
					}
				}
				else{
					frames = settings.frames;
				}

				t.data('sprite_frames',frames);
			}

			return t;

		};


		var methods = {
			goto:function(f){
				var frames = this.data('sprite_frames');
				if (frames){
					var frame = frames[f];
					if (frame || frame === 0){ // 0 evaluates to false, so strict check
						this.css('background-position',-frame[0]+'px '+-frame[1]+'px');
					}
				}
			}
		};

		

	})($);


	$(function(){

		$('.sprite').sprite({
			sheetWidth:1024,
			sheetHeight:256,
			frames:10
		}).sprite('goto',3);

	});



	</script>
</head>

<body>

<div class="sprite">&nbsp;</div>

</body>
</html>
